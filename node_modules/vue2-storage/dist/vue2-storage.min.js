!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):(t=t||self,e(t.Vue2Storage={}))}(this,function(t){"use strict";function e(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,o){for(var s,c,u=e(t),f=1;f<arguments.length;f++){s=Object(arguments[f]);for(var a in s)n.call(s,a)&&(u[a]=s[a]);if(r){c=r(s);for(var h=0;h<c.length;h++)i.call(s,c[h])&&(u[c[h]]=s[c[h]])}}return u};const s={};class c{get length(){return Object.keys(this.storage).length}get storage(){return s}getItem(t){return t in this.storage?this.storage[t]:null}setItem(t,e){this.storage[t]=e}removeItem(t){t in this.storage&&delete this.storage[t]}clear(){const t=Object.keys(this.storage);for(let e=0;e<=t.length;e++)try{delete this.storage[t[e]]}catch(t){}}}var u,f=new c;!function(t){t.LOCAL="local",t.SESSION="session",t.MEMORY="memory"}(u||(u={}));class a{constructor(t={}){this.setOptions(t)}get length(){return this.keys().length}get prefix(){return this.options.prefix}get name(){return"vue2-storage"}get version(){return"4.0.5"}get driver(){switch(this.options.driver){case u.LOCAL:default:return"undefined"!=typeof window?window.localStorage:f;case u.SESSION:return"undefined"!=typeof window?window.sessionStorage:f;case u.MEMORY:return f}}setOptions(t={}){const e=o({prefix:"app_",driver:u.LOCAL,ttl:864e5},t);this.options=Object.freeze(e)}get(t,e=null){try{const r=this.fromJSON(this.addPrefix(t));return null===r?e:r}catch(t){this.printError(t)}}set(t,e,r={}){try{this.driver.setItem(this.addPrefix(t),this.toJSON(e,r))}catch(t){this.printError(t)}}remove(t){try{this.driver.removeItem(this.addPrefix(t))}catch(t){this.printError(t)}}clear(t=!1){try{if(t)this.driver.clear();else{const t=this.keys().filter(t=>t.startsWith(this.options.prefix||""));t.forEach(t=>this.remove(this.removePrefix(t)))}}catch(t){this.printError(t)}}has(t){return this.options.driver!==u.MEMORY?this.addPrefix(t)in this.driver:this.addPrefix(t)in this.driver.storage}key(t){try{const e=this.keys()[t];return this.get(this.removePrefix(e))}catch(t){this.printError(t)}}keys(){return this.options.driver!==u.MEMORY?Object.keys(this.driver):Object.keys(this.driver.storage)}addPrefix(t){return`${this.options.prefix||""}${t}`}removePrefix(t){const e=new RegExp(`^${this.options.prefix||""}`);return t.replace(e,"")}toJSON(t,e={}){const r="ttl"in e?e.ttl:this.options.ttl;return JSON.stringify({value:t,ttl:Date.now()+r})}fromJSON(t){try{const e=JSON.parse(this.driver.getItem(t));return null!==e?"ttl"in e&&Number(e.ttl)<Date.now()?(this.remove(this.removePrefix(t)),null):"value"in e?e.value:e:null}catch(t){return null}}printError(t){console.error(`${this.name}[${this.version}]: ${t.stack}`)}}class h{static install(t,e){const r=new a(e);t.$storage=r,t.prototype.$storage=r}}"undefined"!=typeof window&&(window.Vue2Storage=h),t.Vue2Storage=h,t.default=h,Object.defineProperty(t,"__esModule",{value:!0})});
